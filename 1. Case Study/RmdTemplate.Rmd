---
title: "Case Study 1"
subtitle: "AKSTA Statistical Computing 107.258"
author: "Maximilian Hagn"
date: "21. April 2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Ratio of Fibonacci numbers

## Using a for Loop

```{r, echo=TRUE}
fibonacci_for <- function(n) {
  f_i <- 1
  zahl1 <- 0
  zahl2 <- 1
  for(i in 0:(n-1)) {
    f_i = zahl1 + zahl2
    zahl1 = zahl2
    zahl2 = f_i
  }
  return(zahl2/zahl1)
}
```

## Using a while Loop

```{r, echo=TRUE}
fibonacci_while <- function(n) {
  i = 0
  f_i <- 1
  zahl1 <- 0
  zahl2 <- 1
  while(i <= (n-1)) {
    f_i = zahl1 + zahl2
    zahl1 = zahl2
    zahl2 = f_i
    i = i + 1
  }
  return(zahl2/zahl1)
}
```

## Benchmark

```{r, echo=TRUE}
library(microbenchmark)
n <- 100
m <- 1000

mbm_n <- microbenchmark(fibonacci_for(n), fibonacci_while(n))
mbm_n

mbm_m <- microbenchmark(fibonacci_for(m), fibonacci_while(m))
mbm_m
```

Hier kommt eine Erklärung hin. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.

## Plot

```{r, echo=TRUE}
library(ggplot2)
```

```{r, fig.align='center', fig.width=4, fig.height=4}
autoplot(mbm_n) #n = 100
```

```{r, fig.align='center', fig.width=4, fig.height=4}
autoplot(mbm_m) #m = 1000
```

Hier kommt eine Erklärung hin. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.

# The golden ratio

```{r, echo=TRUE}
golden_ratio_fib_test <- function(n) {
  print(fibonacci_for(n)/fibonacci_for(n-1))
  print((fibonacci_for(n) + fibonacci_for(n-1)) / fibonacci_for(n))
}

golden_ratio <- (sqrt(5) + 1)/2

test_vals = c(1, 5, 10, 25, 40, 50, 100, 500, 1000)

check_golden_ratio_1 <- function(vals) {
  for(i in vals){
    print(paste("fibonacci(", i, "): ", fibonacci_for(i) == golden_ratio))
  }
}

check_golden_ratio_1(test_vals)

```


# Game of craps

Hier kommt eine Erklärung hin. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.

```{r, echo=TRUE}

game_of_craps <- function() {
  #First round
  round <- 1
  dice_1 <- sample(1:6, 1)
  dice_2 <- sample(1:6, 1)
  dice_sum <- dice_1 + dice_2
  first_x <- dice_1 + dice_2
  if(dice_sum == 7 || dice_sum == 11){
    return(paste("Game won in round ", round, "| x = ", dice_sum))
  }
  #Following rounds
  while(TRUE) {
    round = round + 1
    dice_1 <- sample(1:6, 1)
    dice_2 <- sample(1:6, 1)
    dice_sum <- dice_1 + dice_2
    if(dice_sum == first_x){
      return(paste("Game won in round ", round, "| x = ", dice_sum))
    }
    if(dice_sum == 7 || dice_sum == 11){
      return(paste("Game lost in round ", round, "| x = ", dice_sum))
    }
  }
}

```

Hier kommt eine Erklärung hin. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Hier kommt eine Erklärung hin. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.

# Readable and efficient code

## foobar0

```{r, echo=TRUE}

foobar0 <- function(x, z) {
  set.seed(1)
  
  if (sum(x >= .001) < 1) {
    stop("step 1 requires 1 observation(s) with value >= .001")
  }
  
  fit <- lm(x ~ z)
  r <- fit$residuals
  x <- sin(r) + .01
  
  if (sum(x >= .002) < 2) {
    stop("step 2 requires 2 observation(s) with value >= .002")
  }
  
  fit <- lm(x ~ z)
  r <- fit$residuals
  x <- 2 * sin(r) + .02
  if (sum(x >= .003) < 3) {
   stop("step 3 requires 3 observation(s) with value >= .003")
  }
  
  fit <- lm(x ~ z)
  r <- fit$residuals
  x <- 3 * sin(r) + .03
  
  if (sum(x >= .004) < 4) {
    stop("step 4 requires 4 observation(s) with value >= .004")
  }
  
  fit <- lm(x ~ z)
  r <- fit$residuals
  x <- 4 * sin(r) + .04
  
  return(x)
}

```

## Rewrite

```{r, echo=TRUE}

check_input <- function(x, step) {
  if (sum(x >= (step * .001)) < step) {
    stop(paste("step ", step, " requires ", step, " observation(s) with value >= ", (step * .001)))
  }
}
  
compute <- function(x, z, step) {
  fit <- lm(x ~ z)
  r <- fit$residuals
  x <- step * sin(r) + (.01 * step)
  return(x)
}
  
foobar <- function(x, z) {
  set.seed(1)
  check_input(x, 1)
  x <- compute(x, z, 1)
  check_input(x, 2)
  x <- compute(x, z, 2)
  check_input(x, 3)
  x <- compute(x, z, 3)
  check_input(x, 4)
  x <- compute(x, z, 4)
  return(x)
}

```

## Equality

```{r, echo=TRUE}

all.equal(foobar0(rnorm(100), rnorm(100)), foobar(rnorm(100), rnorm(100)))

```

